<!DOCTYPE html>
<html>
  <head>
    <title>Intro to data processing</title>
    <meta charset="utf-8">
    <meta name="author" content="Jakub Nowosad" />
    <link href="libs/remark-css/example.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Intro to data processing
### Jakub Nowosad

---





---
# Data processing

## Dataset


```r
# install.packages('devtools')
# devtools::install_github("jennybc/gapminder")
library('gapminder')
```

or


```r
gapminder &lt;- readRDS('data/gapminder.rds')
```

http://www.gapminder.org/data/

http://github.com/jennybc/gapminder

http://www.youtube.com/watch?v=jbkSRLYSojo

---
# R 

## Vectors - indexing

- brak indeksu
- indeks dodatni
- indeks zerowy
- indeks ujemny
- indeks logiczny
- indeks tekstowy

---
## data.frame - indexing

- object[row,column]

```r
gapminder[2, 1]
gapminder[1, 3]
gapminder[, 1]
gapminder[1]
gapminder[1, ]
gapminder[0, 3]
gapminder[-2, ]
gapminder[, -1]
gapminder[c(1,5,7), ]
gapminder[, c(1,2)]
gapminder[gapminder$pop&lt;100000, ]
gapminder[gapminder$year==1952, c(4)]
```

---
## data.frame - indexing


```r
gapminder$lifeExp
```


```r
gapminder$continent
```


---
## **dplyr**


```r
# install.packages('dplyr')
# devtools::install_github("hadley/dplyr")
library('dplyr')
```

- **dplyr** to pakiet służący do podstawowych operacji przetwarzania danych z wykrzystaniem obiektów typu data.frame
- podstawowe funkcje pakietu **dplyr** to *select*, *arrange*, *filter*, *mutate*, oraz *summarize*
- dodatkowo ważną rolę spełnia funkcja *group_by*
- inne możliwości pakietu **dplyr** to operator łączący funkcje ( %&gt;% ), złączenia ("join") czy operacje w ruchomym oknie 

---
## **dplyr** - *select*

- funkcja *select* pozwala na stworzenie obiektu zawierającego tylko wybrane kolumny
- ta funkcja pozwala zarówno na wybór pozytywny jak i negatywny
- wiele dodatkowych możliwości - ?dplyr::select

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; continent &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; year &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; lifeExp &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; pop &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; gdpPercap &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1952 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 28.801 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8425333 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 779.4453 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1957 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 30.332 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9240934 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 820.8530 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1962 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 31.997 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10267083 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 853.1007 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1967 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 34.020 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11537966 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 836.1971 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1972 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 36.088 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 13079460 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 739.9811 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1977 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 38.438 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14880372 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 786.1134 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
## **dplyr** - *select*


```r
gapminder_sel1 &lt;- select(gapminder, country, year, pop)
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; year &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; pop &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1952 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8425333 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1957 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9240934 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


```r
gapminder_sel2 &lt;- select(gapminder, -continent)
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; year &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; lifeExp &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; pop &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; gdpPercap &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1952 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 28.801 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8425333 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 779.4453 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1957 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 30.332 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9240934 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 820.8530 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
## **dplyr** - *arrange*

- funkcja *arrange* sortuje wybrane kolumny w kolejności rosnącej...


```r
gapminder_arr1 &lt;- arrange(gapminder, lifeExp)
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; continent &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; year &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; lifeExp &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; pop &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; gdpPercap &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Rwanda &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Africa &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1992 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 23.599 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7290203 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 737.0686 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1952 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 28.801 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8425333 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 779.4453 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Gambia &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Africa &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1952 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 30.000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 284320 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 485.2307 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Angola &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Africa &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1952 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 30.015 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4232095 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3520.6103 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Sierra Leone &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Africa &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1952 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 30.331 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2143249 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 879.7877 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
## **dplyr** - *arrange*

- ...lub malejącej


```r
gapminder_arr1 &lt;- arrange(gapminder, desc(lifeExp))
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; continent &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; year &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; lifeExp &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; pop &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; gdpPercap &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Japan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2007 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 82.603 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 127467972 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 31656.07 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Hong Kong, China &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2007 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 82.208 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6980412 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 39724.98 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Japan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2002 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 82.000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 127065841 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 28604.59 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Iceland &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Europe &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2007 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 81.757 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 301931 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 36180.79 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Switzerland &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Europe &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2007 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 81.701 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7554661 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 37506.42 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
## **dplyr** - *filter*

- funkcja *filter* pozwala na wybranie tylko tych obserwacji (wierszy), które spełniają zadane warunki
- warunki określane są przez operatory logiczne: ==, !=, &gt;, &gt;=, &lt;, &lt;=, &amp;, |


```r
gapminder_fil1 &lt;- filter(gapminder, year == 2007)
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; continent &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; year &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; lifeExp &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; pop &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; gdpPercap &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2007 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 43.828 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 31889923 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 974.5803 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Albania &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Europe &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2007 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 76.423 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3600523 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5937.0295 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
## **dplyr** - *filter*


```r
gapminder_fil2 &lt;- filter(gapminder, year == 2007 &amp; pop &lt;= 999999)
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; continent &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; year &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; lifeExp &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; pop &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; gdpPercap &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Bahrain &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2007 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 75.635 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 708573 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 29796.0483 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Comoros &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Africa &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2007 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 65.152 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 710960 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 986.1479 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


```r
gapminder_fil2 &lt;- filter(gapminder, continent != 'Asia' |  lifeExp &lt; 30)
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; continent &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; year &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; lifeExp &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; pop &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; gdpPercap &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1952 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 28.801 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8425333 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 779.4453 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Albania &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Europe &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1952 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 55.230 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1282697 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1601.0561 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
## **dplyr** - *mutate*

- funkcja *mutate* dodaje nowe zmienne (kolumny) na podstawe zadanego wyrażenia


```r
gapminder_mut1 &lt;- mutate(gapminder, gdp_mil = (gdpPercap * pop) / 1000000)
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; continent &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; year &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; lifeExp &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; pop &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; gdpPercap &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; gdp_mil &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1952 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 28.801 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8425333 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 779.4453 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6567.086 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1957 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 30.332 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9240934 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 820.8530 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7585.449 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1962 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 31.997 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10267083 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 853.1007 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8758.856 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1967 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 34.020 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11537966 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 836.1971 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9648.014 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1972 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 36.088 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 13079460 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 739.9811 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9678.553 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
## **dplyr** - *summarize*

- funkcja *summarize* służy do tworzenia podsumowań statystycznych; tworzy kolumny z zadanymi statystykami opisowymi


```r
gapminder_sum1 &lt;- summarize(gapminder, mean_le = mean(lifeExp))
```


```
##    mean_le
## 1 59.47444
```


```r
gapminder_sum2 &lt;- summarize(gapminder, mean_le = mean(lifeExp), min_le = min(lifeExp), max_le = max(lifeExp))
```


```
##    mean_le min_le max_le
## 1 59.47444 23.599 82.603
```

---
## **dplyr** - *group_by*

- funkcja *group_by* sama nie tworzy wyników, pozwala jednak na wyliczanie wyniów według zadanej agregacji


```r
gapminder2007 &lt;- filter(gapminder, year == 2007)
gapminder_grp1 &lt;- group_by(gapminder2007, continent)
```


```
## Source: local data frame [6 x 6]
## Groups: continent [5]
## 
##       country continent  year lifeExp      pop  gdpPercap
##        &lt;fctr&gt;    &lt;fctr&gt; &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
## 1 Afghanistan      Asia  2007  43.828 31889923   974.5803
## 2     Albania    Europe  2007  76.423  3600523  5937.0295
## 3     Algeria    Africa  2007  72.301 33333216  6223.3675
## 4      Angola    Africa  2007  42.731 12420476  4797.2313
## 5   Argentina  Americas  2007  75.320 40301927 12779.3796
## 6   Australia   Oceania  2007  81.235 20434176 34435.3674
```

---
## **dplyr** - *group_by*


```r
gapminder_grp1 &lt;- summarize(gapminder_grp1, mean_lifeExp = mean(lifeExp))
```


&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; continent &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; mean_lifeExp &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Africa &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 54.80604 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Americas &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 73.60812 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 70.72848 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Europe &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 77.64860 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Oceania &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 80.71950 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
# **tidyr**

## **tidyr**


```r
# install.packages('tidyr')
library('tidyr')
```

- często dane jakie posiadamy są ułożone nie w ten sposób jaki my czy też różne funkcje R oczekują; ważne jest, aby dane były uporządkowane (tzw. "tidy data"), co oznacza, że:
    - każda kolumna to zmienna
    - każdy wiersz to obserwacja
- istnieją dwie podstawowe układy danych, tzw. dane szerokie (wide) oraz dane długie (long)      
- więcej szczegółów można znaleźć pod adresem http://vita.had.co.nz/papers/tidy-data.html
- pakiet **tidyr** posiada dwie główne funkcje - *gather* and *spread* oraz szereg dodatkowych

---
## **tidyr** - *spread*

- celem funkcji *spread* jest przetworzenie danych na tzw. dane szerokie 
- konieczne jest, aby dane miały tylko jeden unikalny identyfikator


```r
gapminder &lt;- select(gapminder, -continent, -lifeExp, -gdpPercap)
gapminder_spread &lt;- spread(gapminder, country, pop)
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; year &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Afghanistan &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Albania &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Algeria &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Angola &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Argentina &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Australia &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Austria &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Bahrain &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Bangladesh &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1952 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8425333 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1282697 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9279525 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4232095 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 17876956 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8691212 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6927772 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 120447 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 46886859 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1957 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9240934 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1476505 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10270856 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4561361 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 19610538 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9712569 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6965860 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 138655 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 51365468 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1962 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10267083 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1728137 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11000948 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4826015 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 21283783 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10794968 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7129864 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 171863 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 56839289 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1967 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11537966 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1984060 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12760499 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5247469 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 22934225 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11872264 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7376998 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 202182 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 62821884 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1972 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 13079460 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2263554 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14760787 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5894858 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 24779799 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 13177000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7544201 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 230800 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 70759295 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
## **tidyr** - *gather*

- funkcja *gather* przetwarza dane na postać tzw. długą


```r
gapminder_gather &lt;- gather(gapminder_spread, country, pop, -year)
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; year &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; pop &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1952 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8425333 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1957 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9240934 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1962 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10267083 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1967 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11537966 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1972 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 13079460 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('showSlide', function (slide) {setTimeout(function() {window.dispatchEvent(new Event('resize'));}, 100)});</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
  }
});
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
